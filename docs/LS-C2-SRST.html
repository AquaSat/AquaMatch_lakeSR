<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 lakeSR-LS_C2_SRST Data Product | lakeSR: Compiled Satellite Surface Reflectance and Surface Temperature for Lakes in the United States and US Territories</title>
  <meta name="description" content="Acquisition and compilation of satellite surface reflectance data for all lakes in the United States and US Territories." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="5 lakeSR-LS_C2_SRST Data Product | lakeSR: Compiled Satellite Surface Reflectance and Surface Temperature for Lakes in the United States and US Territories" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Acquisition and compilation of satellite surface reflectance data for all lakes in the United States and US Territories." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 lakeSR-LS_C2_SRST Data Product | lakeSR: Compiled Satellite Surface Reflectance and Surface Temperature for Lakes in the United States and US Territories" />
  
  <meta name="twitter:description" content="Acquisition and compilation of satellite surface reflectance data for all lakes in the United States and US Territories." />
  

<meta name="author" content="ROSSyndicate" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="landsat-collection-2-surface-reflectance-and-surface-temperature.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#code-architecture"><i class="fa fa-check"></i><b>1.1</b> Code Architecture</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="locs-data-acq.html"><a href="locs-data-acq.html"><i class="fa fa-check"></i><b>2</b> Locations of Data Acquisition</a>
<ul>
<li class="chapter" data-level="2.1" data-path="locs-data-acq.html"><a href="locs-data-acq.html#changes-from-aquasat-v1"><i class="fa fa-check"></i><b>2.1</b> Changes from AquaSat v1</a></li>
<li class="chapter" data-level="2.2" data-path="locs-data-acq.html"><a href="locs-data-acq.html#pole-of-inaccessibility"><i class="fa fa-check"></i><b>2.2</b> Pole of Inaccessibility</a></li>
<li class="chapter" data-level="2.3" data-path="locs-data-acq.html"><a href="locs-data-acq.html#waterbodies"><i class="fa fa-check"></i><b>2.3</b> Waterbodies in AquaMatch-lakeSR</a></li>
<li class="chapter" data-level="2.4" data-path="locs-data-acq.html"><a href="locs-data-acq.html#technical-implementation"><i class="fa fa-check"></i><b>2.4</b> Technical Implementation</a></li>
<li class="chapter" data-level="2.5" data-path="locs-data-acq.html"><a href="locs-data-acq.html#case-study-wisconsin-waterbodies"><i class="fa fa-check"></i><b>2.5</b> Case Study: Wisconsin Waterbodies</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="software-settings.html"><a href="software-settings.html"><i class="fa fa-check"></i><b>3</b> Satellite Data Acquisition Software and Settings</a>
<ul>
<li class="chapter" data-level="3.1" data-path="software-settings.html"><a href="software-settings.html#reticulate-conda-environment"><i class="fa fa-check"></i><b>3.1</b> {reticulate} Conda Environment</a></li>
<li class="chapter" data-level="3.2" data-path="software-settings.html"><a href="software-settings.html#google-earth-engine-setup"><i class="fa fa-check"></i><b>3.2</b> Google Earth Engine Setup</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="software-settings.html"><a href="software-settings.html#create-a-gee-account"><i class="fa fa-check"></i><b>3.2.1</b> Create a GEE account</a></li>
<li class="chapter" data-level="3.2.2" data-path="software-settings.html"><a href="software-settings.html#gcloud-cli"><i class="fa fa-check"></i><b>3.2.2</b> gcloud CLI</a></li>
<li class="chapter" data-level="3.2.3" data-path="software-settings.html"><a href="software-settings.html#gee-authentication"><i class="fa fa-check"></i><b>3.2.3</b> GEE Authentication</a></li>
<li class="chapter" data-level="3.2.4" data-path="software-settings.html"><a href="software-settings.html#gee-project-setting"><i class="fa fa-check"></i><b>3.2.4</b> GEE project setting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><i class="fa fa-check"></i><b>4</b> Landsat Collection 2 Surface Reflectance and Surface Temperature</a>
<ul>
<li class="chapter" data-level="4.1" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html#background-information"><i class="fa fa-check"></i><b>4.1</b> Background Information</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html#spectral-response"><i class="fa fa-check"></i><b>4.1.1</b> Spectral Response</a></li>
<li class="chapter" data-level="4.1.2" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html#sensor-resolution"><i class="fa fa-check"></i><b>4.1.2</b> Sensor Resolution</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html#surface-reflectance-product"><i class="fa fa-check"></i><b>4.2</b> Surface Reflectance Product</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html#sr-atmospheric-processing"><i class="fa fa-check"></i><b>4.2.1</b> SR Atmospheric Processing</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="landsat-collection-2-surface-reflectance-and-surface-temperature.html"><a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html#surface-temperature"><i class="fa fa-check"></i><b>4.3</b> Surface Temperature</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html"><i class="fa fa-check"></i><b>5</b> lakeSR-LS_C2_SRST Data Product</a>
<ul>
<li class="chapter" data-level="5.1" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#technical-implementation-of-acquisition-script"><i class="fa fa-check"></i><b>5.2</b> Technical Implementation of Acquisition Script</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#custom-functions"><i class="fa fa-check"></i><b>5.2.1</b> Custom Functions</a></li>
<li class="chapter" data-level="5.2.2" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#defining-water-area"><i class="fa fa-check"></i><b>5.2.2</b> Defining water area</a></li>
<li class="chapter" data-level="5.2.3" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#setup"><i class="fa fa-check"></i><b>5.2.3</b> Setup</a></li>
<li class="chapter" data-level="5.2.4" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#collating-earth-engine-objects-for-extraction"><i class="fa fa-check"></i><b>5.2.4</b> Collating Earth Engine objects for extraction</a></li>
<li class="chapter" data-level="5.2.5" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#payload-handling"><i class="fa fa-check"></i><b>5.2.5</b> Payload handling</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#changes-from-aquasat-v1-1"><i class="fa fa-check"></i><b>5.3</b> Changes from AquaSat v1</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">lakeSR: Compiled Satellite Surface Reflectance and Surface Temperature for Lakes in the United States and US Territories</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="LS-C2-SRST" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> lakeSR-LS_C2_SRST Data Product<a href="LS-C2-SRST.html#LS-C2-SRST" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The lakeSR data product is a set of tabular datasets, representing the surface
reflectance (SR) and surface tempearture (ST) data summarized for the point of
inaccessibility (POI) location which is meant to represent pelagic conditions at
a given waterbody (identified by its NHD unique identifier, see Section
<a href="locs-data-acq.html#locs-data-acq">2</a>). This data product contains “full stacks” of the Landsat
Collection 2 record - that is, all summarized Landsat data available from all
Landsat missions that met our QA criteria.</p>
<div id="overview" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Overview<a href="LS-C2-SRST.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The workflow for data acquisition is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>read in and format the yaml configuration file for the GEE run
(<code>b_config_file_poi</code>, <code>b_yml_poi</code>)</p></li>
<li><p>reformat the locations file for the GEE run using the configuration file
(<code>b_ref_locations_poi</code>)</p></li>
<li><p>determine the WRS-2 path-rows that intersect with the locations file
(<code>b_WRS_pathrow_poi</code>)</p></li>
<li><p>filter the locations for those that are completely contained by the WRS-2
path-row when the automated buffer is added, add the WRS-2 path-rows to the
reformatted locations, and save distinct location files by path-row for
easier processing in Python (<code>b_poi_locs_filtered</code>)</p></li>
<li><p>iteratively run the GEE script per WRS-2 path-row (<code>b_eeRun_poi</code>)</p></li>
<li><p>check to see that all tasks are complete in GEE before moving to next step
(<code>b_poi_tasks_complete</code>)</p></li>
<li><p>check to see if any tasks failed in GEE extraction which is not visible from
the RStudio IDE (<code>b_check_for_failed_tasks</code>)</p></li>
</ol>
</div>
<div id="technical-implementation-of-acquisition-script" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Technical Implementation of Acquisition Script<a href="LS-C2-SRST.html#technical-implementation-of-acquisition-script" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to cue Python scripts and map along WRS-2 path-rows within the
{targets} architecture, we use a function (<code>run_GEE_per_pathrow()</code>) which writes
the current WRS-2 path-row to a text file, then sources a python script that
uses that text file to run the acquisition for the path-row. Additional details
are provided below to describe the steps in the python script
(<code>run_GEE_per_pathrow.py</code>).</p>
<div id="custom-functions" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Custom Functions<a href="LS-C2-SRST.html#custom-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first section of <code>run_GEE_per_pathrow.py</code> saves custom functions used in the
Landsat stack acquisition. These include data manipulation to create Earth
Engine (EE) objects, custom QA masks, DSWE algorithm, and the functions that
perform the masking and extraction of data from the Landsat image. Below is an
overview of some of the custom masking procedures and their justification, if
available.</p>
<ul>
<li><p><code>apply_rad_mask</code>: Masks out all pixels that are radiometrically saturated in
any optical band using the QA_RADSAT QA band</p></li>
<li><p><code>apply_cf_mask</code>: Applies mask for any pixels obstructed by clouds and
snow/ice using the CLOUD_QA band</p></li>
<li><p><code>apply_sr_aero_mask</code>: Applies mask for any pixels in Landsat 8 and 9 that
have ‘medium’ or ‘high’ aerosol QA flags from the SR_QA_AEROSOL band</p></li>
<li><p><code>apply_opac_mask</code>: Applies mask to remove pixels where atmospheric opacity
is greater than 0.3 in Landsat 4, 5, and 7 using the SR_ATMOS_OPACITY band</p></li>
<li><p><code>apply_fill_mask_457</code> and <code>apply_fill_mask_89</code>: Applies a mask where any
band value is 0 before applying scaling factors to bands</p></li>
<li><p><code>apply_realistic_mask_457</code> and <code>apply_realistic_mask_89</code>: Applies a mask
where any band is less than -0.01 after scaling, indicating overcorrection
of SR product</p></li>
</ul>
</div>
<div id="defining-water-area" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Defining water area<a href="LS-C2-SRST.html#defining-water-area" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>DSWE</code>: Calculates the dynamic surface water extent per pixel, as defined by
<span class="citation">Jones (<a href="#ref-jones2019">2019</a>)</span> and <span class="citation">US Geological Survey (<a href="#ref-usgeologicalsurveya">n.d.a</a>)</span>, within the scope of lakeSR we extract DSWE
1 and what we refer to as <code>DSWE1a</code>, described later.</p>
<ul>
<li><p>a value of 0 indicates no water/fill</p></li>
<li><p>1 is confident water</p></li>
<li><p>2 is low confidence water</p></li>
<li><p>3 is high confidence partial water (or vegetated water)</p></li>
<li><p>4 is low confidence partial water</p></li>
</ul>
<p>These functions are</p>
</div>
<div id="setup" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Setup<a href="LS-C2-SRST.html#setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first 50 lines of the <code>run_GEE_per_pathrow.py</code> file import Python modules
(lines 2-8), read in the formatted configuration file (line 11) and assign
environment variables (lines 13-41), read in the text file that stores the
current tile (lines 43-45) created by the <code>run_GEE_per_tile()</code> function called
in the <code>eeRun_poi</code> target), and read in the locations file created in the target
<code>poi_locs_WRS_latlon</code> then subset it for locations that are within the current
tile (lines 47-50).</p>
</div>
<div id="collating-earth-engine-objects-for-extraction" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Collating Earth Engine objects for extraction<a href="LS-C2-SRST.html#collating-earth-engine-objects-for-extraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next section of code (lines 52-129) collates the Landsat stacks and formats
them for data extraction.</p>
<p>Each Earth Engine Image Collection (<code>ee.ImageCollection</code> in the script) for each
Landsat mission is filtered for total cloud cover in the scene (<code>CLOUD_COVER</code>,
set at &lt;90%), the date range of interest (all images until 2023-07-01), the
current <code>tile</code> path and row value, and then unscaled from the digital number
(DN) values that the data are stored in. Below is a code chunk as an example of
this process for Landsat 7 (lines 61-66). Note that <code>cloud_thresh</code>, <code>yml_start</code>,
<code>yml_end</code> are configuration settings, <code>w_p</code> and <code>w_r</code> represent the current
<em>path</em> and <em>row</em> of the WRS-2 tile.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="LS-C2-SRST.html#cb1-1" tabindex="-1"></a>l7 <span class="op">=</span> (ee.ImageCollection(<span class="st">&quot;LANDSAT/LE07/C02/T1_L2&quot;</span>)</span>
<span id="cb1-2"><a href="LS-C2-SRST.html#cb1-2" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.lt(<span class="st">&quot;CLOUD_COVER&quot;</span>, ee.Number.parse(<span class="bu">str</span>(cloud_thresh))))</span>
<span id="cb1-3"><a href="LS-C2-SRST.html#cb1-3" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.eq(<span class="st">&quot;WRS_PATH&quot;</span>, w_p))</span>
<span id="cb1-4"><a href="LS-C2-SRST.html#cb1-4" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.eq(<span class="st">&quot;WRS_ROW&quot;</span>, w_r))</span>
<span id="cb1-5"><a href="LS-C2-SRST.html#cb1-5" tabindex="-1"></a>    .filterDate(yml_start, yml_end)</span>
<span id="cb1-6"><a href="LS-C2-SRST.html#cb1-6" tabindex="-1"></a>    .<span class="bu">map</span>(apply_scale_factors))</span></code></pre></div>
<p>The function <code>apply_scale_factors()</code> is a prescribed function which is
consistent across all Landsat Collection 2 Level 2 SR and ST products to
transform the DN to remote sensing reflectance (Rrs) values with the following
function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="LS-C2-SRST.html#cb2-1" tabindex="-1"></a><span class="kw">def</span> apply_scale_factors(image):</span>
<span id="cb2-2"><a href="LS-C2-SRST.html#cb2-2" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot; Applies scaling factors for Landsat Collection 2 surface reflectance </span></span>
<span id="cb2-3"><a href="LS-C2-SRST.html#cb2-3" tabindex="-1"></a><span class="co">  and surface temperature products</span></span>
<span id="cb2-4"><a href="LS-C2-SRST.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="LS-C2-SRST.html#cb2-5" tabindex="-1"></a><span class="co">  Args:</span></span>
<span id="cb2-6"><a href="LS-C2-SRST.html#cb2-6" tabindex="-1"></a><span class="co">      image: one ee.Image of an ee.ImageCollection</span></span>
<span id="cb2-7"><a href="LS-C2-SRST.html#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="LS-C2-SRST.html#cb2-8" tabindex="-1"></a><span class="co">  Returns:</span></span>
<span id="cb2-9"><a href="LS-C2-SRST.html#cb2-9" tabindex="-1"></a><span class="co">      ee.Image with band values overwritten by scaling factors</span></span>
<span id="cb2-10"><a href="LS-C2-SRST.html#cb2-10" tabindex="-1"></a><span class="co">  &quot;&quot;&quot;</span></span>
<span id="cb2-11"><a href="LS-C2-SRST.html#cb2-11" tabindex="-1"></a>  opticalBands <span class="op">=</span> image.select(<span class="st">&quot;SR_B.&quot;</span>).multiply(<span class="fl">0.0000275</span>).add(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb2-12"><a href="LS-C2-SRST.html#cb2-12" tabindex="-1"></a>  thermalBands <span class="op">=</span> image.select(<span class="st">&quot;ST_B.*&quot;</span>).multiply(<span class="fl">0.00341802</span>).add(<span class="fl">149.0</span>)</span>
<span id="cb2-13"><a href="LS-C2-SRST.html#cb2-13" tabindex="-1"></a>  <span class="cf">return</span> image.addBands(opticalBands, <span class="va">None</span>, <span class="va">True</span>).addBands(thermalBands, <span class="va">None</span>,<span class="va">True</span>)</span></code></pre></div>
<p>The resulting Landsat 4-7 collections are collated into a single
ee.ImageCollection (line 81), and bands are renamed for continuity (lines
83-96). The same is done for Landsat 8 and 9 (lines 99-129). These two
ee.ImageCollections are handled separately, as the pixel-level metadata within
the scenes from these missions is slightly different and processing must be
completed separately.</p>
</div>
<div id="payload-handling" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Payload handling<a href="LS-C2-SRST.html#payload-handling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Because GEE is a free service to those at academic or governmental institutions,
there are limits to the total size of a task sent to GEE for completion. For
this reason, tasks are sent to GEE in 10k location increments per tile (for-loop
encompassing lines 132-321). This is an additional step that is taken in
addition to processing per tile to avoid failed tasks.</p>
</div>
</div>
<div id="changes-from-aquasat-v1-1" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Changes from AquaSat v1<a href="LS-C2-SRST.html#changes-from-aquasat-v1-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-jones2019" class="csl-entry">
Jones, John W. 2019. <span>“Improved Automated Detection of Subpixel-Scale Inundation<span></span>revised Dynamic Surface Water Extent (DSWE) Partial Surface Water Tests.”</span> <em>Remote Sensing</em> 11 (4). <a href="https://doi.org/10.3390/rs11040374">https://doi.org/10.3390/rs11040374</a>.
</div>
<div id="ref-usgeologicalsurveya" class="csl-entry">
US Geological Survey. n.d.a. <span>“Landsat Collection 2 Level-3 Dynamic Surface Water Extent Algorithm Description Document.”</span>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="landsat-collection-2-surface-reflectance-and-surface-temperature.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
