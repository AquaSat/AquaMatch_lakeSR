<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Landsat Collection 2 SRST Data Product | AquaSat v2: lakeSR and siteSR</title>
  <meta name="description" content="Acquisition and compilation of satellite surface reflectance data for all lakes in the United States and US Territories." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Landsat Collection 2 SRST Data Product | AquaSat v2: lakeSR and siteSR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Acquisition and compilation of satellite surface reflectance data for all lakes in the United States and US Territories." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Landsat Collection 2 SRST Data Product | AquaSat v2: lakeSR and siteSR" />
  
  <meta name="twitter:description" content="Acquisition and compilation of satellite surface reflectance data for all lakes in the United States and US Territories." />
  

<meta name="author" content="ROSSyndicate" />


<meta name="date" content="2025-07-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="LS-C2-SRST.html"/>
<link rel="next" href="post-hoc-qa.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#repository-links-for-the-aquamatch-suite"><i class="fa fa-check"></i><b>1.1</b> Repository Links for the AquaMatch Suite</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#note"><i class="fa fa-check"></i><b>1.2</b> Note</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>1.3</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>2</b> Background</a>
<ul>
<li class="chapter" data-level="2.1" data-path="background.html"><a href="background.html#lakesr-code-architecture"><i class="fa fa-check"></i><b>2.1</b> lakeSR Code Architecture</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="background.html"><a href="background.html#lakesr-output-files"><i class="fa fa-check"></i><b>2.1.1</b> lakeSR Output Files</a></li>
<li class="chapter" data-level="2.1.2" data-path="background.html"><a href="background.html#configuration-files"><i class="fa fa-check"></i><b>2.1.2</b> Configuration Files</a></li>
<li class="chapter" data-level="2.1.3" data-path="background.html"><a href="background.html#targets-groups"><i class="fa fa-check"></i><b>2.1.3</b> {targets} groups</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="background.html"><a href="background.html#sitesr-code-architecture"><i class="fa fa-check"></i><b>2.2</b> siteSR Code Architecture</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="background.html"><a href="background.html#sitesr-output-files"><i class="fa fa-check"></i><b>2.2.1</b> siteSR Output Files</a></li>
<li class="chapter" data-level="2.2.2" data-path="background.html"><a href="background.html#setup-description"><i class="fa fa-check"></i><b>2.2.2</b> Configuration Files</a></li>
<li class="chapter" data-level="2.2.3" data-path="background.html"><a href="background.html#targets-groups-1"><i class="fa fa-check"></i><b>2.2.3</b> {targets} Groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="locs-data-acq.html"><a href="locs-data-acq.html"><i class="fa fa-check"></i><b>3</b> Locations of Data Acquisition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="locs-data-acq.html"><a href="locs-data-acq.html#waterbodies"><i class="fa fa-check"></i><b>3.1</b> Waterbodies Included in lakeSR</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="locs-data-acq.html"><a href="locs-data-acq.html#updates-in-aquamatch"><i class="fa fa-check"></i><b>3.1.1</b> Updates in AquaMatch</a></li>
<li class="chapter" data-level="3.1.2" data-path="locs-data-acq.html"><a href="locs-data-acq.html#poi"><i class="fa fa-check"></i><b>3.1.2</b> Pole of Inaccessibility</a></li>
<li class="chapter" data-level="3.1.3" data-path="locs-data-acq.html"><a href="locs-data-acq.html#technical-implementation-of-lakesr"><i class="fa fa-check"></i><b>3.1.3</b> Technical Implementation of lakeSR</a></li>
<li class="chapter" data-level="3.1.4" data-path="locs-data-acq.html"><a href="locs-data-acq.html#lakeSR-shoreline"><i class="fa fa-check"></i><b>3.1.4</b> Flagging shoreline proximity</a></li>
<li class="chapter" data-level="3.1.5" data-path="locs-data-acq.html"><a href="locs-data-acq.html#case-study-wisconsin-waterbodies"><i class="fa fa-check"></i><b>3.1.5</b> Case Study: Wisconsin Waterbodies</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="locs-data-acq.html"><a href="locs-data-acq.html#siteSR-locs"><i class="fa fa-check"></i><b>3.2</b> siteSR Acquisition Locations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="locs-data-acq.html"><a href="locs-data-acq.html#rs-vis"><i class="fa fa-check"></i><b>3.2.1</b> Assessing for remote sensing visibility</a></li>
<li class="chapter" data-level="3.2.2" data-path="locs-data-acq.html"><a href="locs-data-acq.html#fl-wb-assignment"><i class="fa fa-check"></i><b>3.2.2</b> Assignment of NHD flowline and waterbodies</a></li>
<li class="chapter" data-level="3.2.3" data-path="locs-data-acq.html"><a href="locs-data-acq.html#sitesr-updates-in-aquamatch"><i class="fa fa-check"></i><b>3.2.3</b> siteSR updates in AquaMatch</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="software-settings.html"><a href="software-settings.html"><i class="fa fa-check"></i><b>4</b> Satellite Data Acquisition Software and Settings</a>
<ul>
<li class="chapter" data-level="4.1" data-path="software-settings.html"><a href="software-settings.html#r-environment-and-package-information"><i class="fa fa-check"></i><b>4.1</b> R Environment and Package Information</a></li>
<li class="chapter" data-level="4.2" data-path="software-settings.html"><a href="software-settings.html#reticulate-conda-environment"><i class="fa fa-check"></i><b>4.2</b> {reticulate} Conda Environment</a></li>
<li class="chapter" data-level="4.3" data-path="software-settings.html"><a href="software-settings.html#google-earth-engine-setup"><i class="fa fa-check"></i><b>4.3</b> Google Earth Engine Setup</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="software-settings.html"><a href="software-settings.html#create-account"><i class="fa fa-check"></i><b>4.3.1</b> Create a GEE account</a></li>
<li class="chapter" data-level="4.3.2" data-path="software-settings.html"><a href="software-settings.html#gcloud"><i class="fa fa-check"></i><b>4.3.2</b> gcloud CLI</a></li>
<li class="chapter" data-level="4.3.3" data-path="software-settings.html"><a href="software-settings.html#proj-setting"><i class="fa fa-check"></i><b>4.3.3</b> GEE project setting</a></li>
<li class="chapter" data-level="4.3.4" data-path="software-settings.html"><a href="software-settings.html#auth"><i class="fa fa-check"></i><b>4.3.4</b> GEE Authentication</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html"><i class="fa fa-check"></i><b>5</b> Landsat Collection 2 SRST</a>
<ul>
<li class="chapter" data-level="5.1" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#initialisms-and-landsat-jargon"><i class="fa fa-check"></i><b>5.1</b> Initialisms and Landsat Jargon</a></li>
<li class="chapter" data-level="5.2" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#valid-dates"><i class="fa fa-check"></i><b>5.2</b> Background Information</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#band-value-ranges"><i class="fa fa-check"></i><b>5.2.1</b> Band Value Ranges</a></li>
<li class="chapter" data-level="5.2.2" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#sensor-resolution"><i class="fa fa-check"></i><b>5.2.2</b> Sensor Resolution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#surface-reflectance-product"><i class="fa fa-check"></i><b>5.3</b> Surface Reflectance Product</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#atm-corr"><i class="fa fa-check"></i><b>5.3.1</b> SR Atmospheric Processing</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="LS-C2-SRST.html"><a href="LS-C2-SRST.html#st-product"><i class="fa fa-check"></i><b>5.4</b> Surface Temperature</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html"><i class="fa fa-check"></i><b>6</b> Landsat Collection 2 SRST Data Product</a>
<ul>
<li class="chapter" data-level="6.1" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#changes-from-aquasat-v1-and-limnosat-us"><i class="fa fa-check"></i><b>6.1</b> Changes from AquaSat v1 and LimnoSat-US</a></li>
<li class="chapter" data-level="6.2" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#overview-of-acquisition-steps"><i class="fa fa-check"></i><b>6.2</b> Overview of Acquisition Steps</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#custom-config"><i class="fa fa-check"></i><b>6.2.1</b> Creating a Custom Configuration File</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#technical-implementation-of-gee-acquisition-script"><i class="fa fa-check"></i><b>6.3</b> Technical Implementation of GEE Acquisition Script</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#masking-functions"><i class="fa fa-check"></i><b>6.3.1</b> Custom Earth Engine Masking Functions</a></li>
<li class="chapter" data-level="6.3.2" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#dswe-implementation"><i class="fa fa-check"></i><b>6.3.2</b> Defining water area</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#diagnostic-columns"><i class="fa fa-check"></i><b>6.4</b> Additional diagnostic data columns</a></li>
<li class="chapter" data-level="6.5" data-path="LS-SRST-pull.html"><a href="LS-SRST-pull.html#payload-handling"><i class="fa fa-check"></i><b>6.5</b> Payload handling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html"><i class="fa fa-check"></i><b>7</b> Post-Hoc Quality Assurance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#raw-lakesr"><i class="fa fa-check"></i><b>7.1</b> Raw lakeSR stack collation</a></li>
<li class="chapter" data-level="7.2" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#post-hoc-filters"><i class="fa fa-check"></i><b>7.2</b> Post-hoc filters</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#data-truncation"><i class="fa fa-check"></i><b>7.2.1</b> Data Truncation</a></li>
<li class="chapter" data-level="7.2.2" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#landsat-4-qa-summary"><i class="fa fa-check"></i><b>7.2.2</b> Landsat 4 QA Summary</a></li>
<li class="chapter" data-level="7.2.3" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#landsat-5-qa-summary"><i class="fa fa-check"></i><b>7.2.3</b> Landsat 5 QA Summary</a></li>
<li class="chapter" data-level="7.2.4" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#landsat-7-qa-summary"><i class="fa fa-check"></i><b>7.2.4</b> Landsat 7 QA Summary</a></li>
<li class="chapter" data-level="7.2.5" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#landsat-8-qa-summary"><i class="fa fa-check"></i><b>7.2.5</b> Landsat 8 QA Summary</a></li>
<li class="chapter" data-level="7.2.6" data-path="post-hoc-qa.html"><a href="post-hoc-qa.html#landsat-9-qa-summary"><i class="fa fa-check"></i><b>7.2.6</b> Landsat 9 QA Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="define-handoff.html"><a href="define-handoff.html"><i class="fa fa-check"></i><b>8</b> Calculating intermission handoffs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="define-handoff.html"><a href="define-handoff.html#additional-filtering-applied"><i class="fa fa-check"></i><b>8.1</b> Additional filtering applied</a></li>
<li class="chapter" data-level="8.2" data-path="define-handoff.html"><a href="define-handoff.html#roy-method"><i class="fa fa-check"></i><b>8.2</b> Roy method</a></li>
<li class="chapter" data-level="8.3" data-path="define-handoff.html"><a href="define-handoff.html#gardner-method"><i class="fa fa-check"></i><b>8.3</b> Gardner method</a></li>
<li class="chapter" data-level="8.4" data-path="define-handoff.html"><a href="define-handoff.html#implementing-roy-handoffs"><i class="fa fa-check"></i><b>8.4</b> Implementing Roy Handoffs</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="define-handoff.html"><a href="define-handoff.html#roy-deming-correction-landsat-5-to-landsat-7"><i class="fa fa-check"></i><b>8.4.1</b> Roy Deming Correction Landsat 5 to Landsat 7</a></li>
<li class="chapter" data-level="8.4.2" data-path="define-handoff.html"><a href="define-handoff.html#roy-deming-correction-landsat-8-to-landsat-7"><i class="fa fa-check"></i><b>8.4.2</b> Roy Deming Correction Landsat 8 to Landsat 7</a></li>
<li class="chapter" data-level="8.4.3" data-path="define-handoff.html"><a href="define-handoff.html#roy-deming-correction-landsat-7-to-landsat-8"><i class="fa fa-check"></i><b>8.4.3</b> Roy Deming Correction Landsat 7 to Landsat 8</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="define-handoff.html"><a href="define-handoff.html#implementing-gardner-handoffs"><i class="fa fa-check"></i><b>8.5</b> Implementing Gardner Handoffs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="define-handoff.html"><a href="define-handoff.html#gardner-correction-landsat-5-to-landsat-7"><i class="fa fa-check"></i><b>8.5.1</b> Gardner Correction Landsat 5 to Landsat 7</a></li>
<li class="chapter" data-level="8.5.2" data-path="define-handoff.html"><a href="define-handoff.html#gardner-correction-landsat-8-to-landsat-7"><i class="fa fa-check"></i><b>8.5.2</b> Gardner Correction Landsat 8 to Landsat 7</a></li>
<li class="chapter" data-level="8.5.3" data-path="define-handoff.html"><a href="define-handoff.html#gardner-correction-landsat-7-to-landsat-8"><i class="fa fa-check"></i><b>8.5.3</b> Gardner Correction Landsat 7 to Landsat 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AquaSat v2: lakeSR and siteSR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="LS-SRST-pull" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Landsat Collection 2 SRST Data Product<a href="LS-SRST-pull.html#LS-SRST-pull" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The lakeSR data product is a set of tabular datasets, representing the Landsat
surface reflectance (SR) and surface temperarture (ST) data summarized for the
point of inaccessibility (POI) location which is meant to represent conditions
at a given waterbody at a location far from shore (identified by its NHD unique
identifier, see Section <a href="locs-data-acq.html#locs-data-acq">3</a>). This data product contains “full
stacks” of the Landsat Collection 2 record - that is, all summarized Landsat
data available within Google Earth Engine (ending 2024-12-31) from all Landsat
missions that met our within-image QA criteria.</p>
<p>The siteSR data product is similar, but is acquired at unique sampling locations
as described in <a href="locs-data-acq.html#siteSR-locs">3.2</a>.</p>
<div id="changes-from-aquasat-v1-and-limnosat-us" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Changes from AquaSat v1 and LimnoSat-US<a href="LS-SRST-pull.html#changes-from-aquasat-v1-and-limnosat-us" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While much of the general architecture from the previous data products remained
unchanged, in AquaMatch we have added a number of features to the remote sensing
acquisition workflow, have increased efficiency of the data pull, and have made
the acquired data more robust through additional masking. The bullets below
summarize the changes implemented in this update. Code below is pulled from the
Python scripts that acquire the Landsat data from Google Earth Engine. Software
settings are listed in Section <a href="software-settings.html#software-settings">4</a>.</p>
<ul>
<li><p>using yaml file for configuration of the workflow. This allows for greater
flexibility in data acquisition including the use of custom configurations
for the pull.</p></li>
<li><p>assuring location and buffer area are completely contained in a path-row
prior to pulling the data. This reduces erroneous counts of pixels for
locations and buffers that are at the edge of a path-row, assuring that the
buffer distance and included area is consistent per location if it is in the
area of path-row overlap.</p></li>
</ul>
<div class="float">
<img src="images/pathrow-ex.png" width="300" alt="Simplified example: Locations (and their buffers) are the blue circles and the extent of the path-row is indicated by the large dark blue or orange boxes. In this example, location 1 would be extracted for both path-row 1 and 2, location 2 only extracted for path-row 2, and location 3 only extracted for path-row 1." />
<div class="figcaption">Simplified example: Locations (and their buffers) are the blue circles and the
extent of the path-row is indicated by the large dark blue or orange boxes. In
this example, location 1 would be extracted for both path-row 1 and 2, location
2 only extracted for path-row 2, and location 3 only extracted for path-row
1.</div>
</div>
<ul>
<li><p>inclusion of Landsat 4 and Landsat 9. At the time of AquaSat v1 and
LimnoSat-US, Landsat 4 was not easily integrated with other Landsat missions
due to data storage differences. Collection 2 updates allowed for easier
interoperability of the TM sensor (Landsat 4) image series and have
therefore been included in the update. Additionally, Landsat 9 came online
in 2021, and has been added to the data product.</p></li>
<li><p>Landsat Collection 2 offers a Surface Temperature product derived from the
thermal band. In AquaMatch, we include data from this band. See Section
<a href="LS-C2-SRST.html#st-product">5.4</a> for additional considerations in use of these data.</p></li>
<li><p>sending tasks to GEE explicitly per path-row and limiting the Landsat stack
to the explicit path-row to eliminate duplicate acquisitions. In the
previous products, duplicate location/path-row data were acquired because
the extracted Landsat stack was not limited to the explicit WRS path-row
that the point and buffer were in. This meant that locations that were in a
path-row overlap would be extracted twice in two different WRS path-row
extents. The code below is an example of this type of filtering that occurs
per mission as we run a path-row extraction, where we once clipped the stack
to the AOI of the path-row instead of filtering for the path-row itself.
Example below is from code at line 1850 in the file
<code>b_pull_Landsat_SRST_poi/py/run_GEE_per_pathrow.py</code> within the lakeSR
repository.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="LS-SRST-pull.html#cb3-1" tabindex="-1"></a><span class="co"># separate the path-row into path and row values</span></span>
<span id="cb3-2"><a href="LS-SRST-pull.html#cb3-2" tabindex="-1"></a>wrs_pathrow <span class="op">=</span> <span class="st">&quot;013031&quot;</span></span>
<span id="cb3-3"><a href="LS-SRST-pull.html#cb3-3" tabindex="-1"></a>w_p <span class="op">=</span> <span class="bu">int</span>(<span class="bu">str</span>(wrs_pathrow)[:<span class="dv">3</span>])</span>
<span id="cb3-4"><a href="LS-SRST-pull.html#cb3-4" tabindex="-1"></a>w_r <span class="op">=</span> <span class="bu">int</span>(<span class="bu">str</span>(wrs_pathrow)[<span class="op">-</span><span class="dv">3</span>:])</span>
<span id="cb3-5"><a href="LS-SRST-pull.html#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="LS-SRST-pull.html#cb3-6" tabindex="-1"></a><span class="co"># filter the Landsat 7 Collection 2 Tier 1 Level 2 product for the path, row, and valid dates</span></span>
<span id="cb3-7"><a href="LS-SRST-pull.html#cb3-7" tabindex="-1"></a>l7 <span class="op">=</span> (ee.ImageCollection(<span class="st">&quot;LANDSAT/LE07/C02/T1_L2&quot;</span>)</span>
<span id="cb3-8"><a href="LS-SRST-pull.html#cb3-8" tabindex="-1"></a>  .<span class="bu">filter</span>(ee.Filter.eq(<span class="st">&quot;WRS_PATH&quot;</span>, w_p))</span>
<span id="cb3-9"><a href="LS-SRST-pull.html#cb3-9" tabindex="-1"></a>  .<span class="bu">filter</span>(ee.Filter.eq(<span class="st">&quot;WRS_ROW&quot;</span>, w_r))</span>
<span id="cb3-10"><a href="LS-SRST-pull.html#cb3-10" tabindex="-1"></a>  .filterDate(<span class="st">&#39;1999-05-28&#39;</span>, <span class="st">&#39;2019-12-31&#39;</span>))</span></code></pre></div></li>
<li><p>filtering for valid mission dates at Landsat stack step. As seen in the code
chunk above, we also filter for the valid mission dates as detailed in
Section <a href="LS-C2-SRST.html#valid-dates">5.2</a> - in the previous version this was completed
after the Landsat stack was acquired.</p></li>
<li><p>implementation of Collection 2 updates, specifically scaling changes and
updated QA band conventions. The updated scaling factor function is as
follows as directed by the <span class="citation">US Geological Survey (2021)</span> and
<span class="citation">US Geological Survey (2024)</span> documents. Code below from the file
<code>b_pull_Landsat_SRST_poi/py/run_GEE_per_pathrow.py</code> in the lakeSR
repository.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="LS-SRST-pull.html#cb4-1" tabindex="-1"></a><span class="kw">def</span> apply_scale_factors(image):</span>
<span id="cb4-2"><a href="LS-SRST-pull.html#cb4-2" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot; Applies scaling factors for Landsat Collection 2 surface reflectance </span></span>
<span id="cb4-3"><a href="LS-SRST-pull.html#cb4-3" tabindex="-1"></a><span class="co">  and surface temperature products</span></span>
<span id="cb4-4"><a href="LS-SRST-pull.html#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="LS-SRST-pull.html#cb4-5" tabindex="-1"></a><span class="co">  Args:</span></span>
<span id="cb4-6"><a href="LS-SRST-pull.html#cb4-6" tabindex="-1"></a><span class="co">      image: one ee.Image of an ee.ImageCollection</span></span>
<span id="cb4-7"><a href="LS-SRST-pull.html#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="LS-SRST-pull.html#cb4-8" tabindex="-1"></a><span class="co">  Returns:</span></span>
<span id="cb4-9"><a href="LS-SRST-pull.html#cb4-9" tabindex="-1"></a><span class="co">      ee.Image with band values overwritten by scaling factors</span></span>
<span id="cb4-10"><a href="LS-SRST-pull.html#cb4-10" tabindex="-1"></a><span class="co">  &quot;&quot;&quot;</span></span>
<span id="cb4-11"><a href="LS-SRST-pull.html#cb4-11" tabindex="-1"></a>  opticalBands <span class="op">=</span> image.select(<span class="st">&#39;SR_B.&#39;</span>).multiply(<span class="fl">0.0000275</span>).add(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb4-12"><a href="LS-SRST-pull.html#cb4-12" tabindex="-1"></a>  thermalBands <span class="op">=</span> image.select(<span class="st">&#39;ST_B.*&#39;</span>).multiply(<span class="fl">0.00341802</span>).add(<span class="fl">149.0</span>)</span>
<span id="cb4-13"><a href="LS-SRST-pull.html#cb4-13" tabindex="-1"></a>  <span class="cf">return</span> (image</span>
<span id="cb4-14"><a href="LS-SRST-pull.html#cb4-14" tabindex="-1"></a>    .addBands(opticalBands, <span class="va">None</span>, <span class="va">True</span>)</span>
<span id="cb4-15"><a href="LS-SRST-pull.html#cb4-15" tabindex="-1"></a>    .addBands(thermalBands, <span class="va">None</span>, <span class="va">True</span>))</span></code></pre></div></li>
<li><p>masking changes. Many updates were made to assure high quality data through
the use of updated masking procedures. The masks are detailed below in
Section <a href="LS-SRST-pull.html#masking-functions">6.3.1</a>. The cloud mask was also updated to include
all sources of contamination (including cloud shadow and dilated clouds) in
addition to clouds, snow, and ice. The proportion of pixels within the
location buffer that were masked out due to clouds is now tracked as
<code>prop_clouds</code> as an additional method of QA handling downstream of the GEE
extraction.</p></li>
<li><p>DSWE-like implementation for water detection. We have moved from using the
JRC Global Surface Water Mapping Layers <span class="citation">Pekel et al. (2016)</span> to using a modified
Dynamic Surface Water Extent (DSWE) algorithm based on the USGS
implementation of DSWE described in LSDS-2042 version 3
<span class="citation">(US Geological Survey 2023a)</span>. See Section <a href="LS-SRST-pull.html#dswe-implementation">6.3.2</a> for
details.</p></li>
<li><p>removing no-data acquisitions before GEE export. In AquaMatch, we remove any
rows from the summarized GEE product containing no data before export. This
adds efficiency to the pull by removing those rows before export, which is a
source of added time in the GEE bottleneck.</p></li>
<li><p>checking for failed tasks in GEE. For AquaMatch, a failed task would
indicate that a path-row acquisition had an error and was not completed
within GEE. If a task fails (e.g. has an error when running), the task will
be documented within the workflow in the file
b_pull_Landsat_SRST_poi/out/GEE_failed_tasks_vRUN_DATE.txt, where “RUN_DATE”
is the date noted in the GEE_config.yml file. While this rarely occurs,
without checking the task history in GEE a user would not know if there were
path-row acquisitions that failed.</p></li>
</ul>
</div>
<div id="overview-of-acquisition-steps" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Overview of Acquisition Steps<a href="LS-SRST-pull.html#overview-of-acquisition-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The workflow for data acquisition from GEE for lakeSR and siteSR is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>read in and format the yaml configuration file
(<code>b_pull_Landsat_SRST_poi/config_files/config_poi.yml</code> for lakeSR or
<code>gee_config.yml</code> for siteSR) for the GEE run</p></li>
<li><p>reformat the locations file declared within the configuration file for the
GEE run</p></li>
<li><p>determine the WRS-2 path-rows that intersect with the locations contained
within the locations file</p></li>
<li><p>filter the locations (with their buffer that is declared in the
configuration file applied) for those that are completely contained by WRS-2
path-rows</p></li>
<li><p>iteratively run the GEE script (<code>run_GEE_per_pathrow.py</code>) per WRS-2 path-row
to extract remote sensing data from Google Earth Engine for the locations
contained in that pathrow</p></li>
<li><p>check to see that all tasks are complete in GEE before moving to next step</p></li>
<li><p>check to see if any tasks failed in GEE extraction which is not visible from
the RStudio IDE</p></li>
</ol>
<div id="custom-config" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Creating a Custom Configuration File<a href="LS-SRST-pull.html#custom-config" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>lakeSR and siteSR can be modified to be run by a user by setting up a new config
file and altering the {targets} workflow to point to that config file. To
configure a new run of this workflow, fill out the yaml file at the file path
<code>b_pull_Landsat_SRST_poi/config_files/config.yml</code> for lakeSR and
<code>gee_config.yml</code> for siteSR. To run the pipeline with this custom configuration,
follow the steps in <code>run_targets.Rmd</code>, which will assure proper set up and run
the pipeline.</p>
<p>If you wish to make changes to any processes that are not indicated in the
config file (using a different set of lakes/source files, remote sensing masking
procedures, summary statistics, QAQC filtering, mission handoff corrections,
etc.) we encourage you to do so. Just remember, this pipeline takes days to run
due to the bottleneck when submitting tasks to Google Earth Engine. If you wish
to extract remote sensing data for specific locations in a lake, we encourage
you to look to our <a href="https://github.com/AquaSat/AquaMatch_siteSR_WQP">siteSR data
product</a> which is more suited
to extracting data of that nature. Please note, calculating hand-off
coefficients from small numbers of lakes may not provide robust enough summary
statistics for intermission comparison and timeseries analysis. See Section
<a href="define-handoff.html#define-handoff">8</a> for additional guidance.</p>
</div>
</div>
<div id="technical-implementation-of-gee-acquisition-script" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Technical Implementation of GEE Acquisition Script<a href="LS-SRST-pull.html#technical-implementation-of-gee-acquisition-script" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to cue Python scripts and map along WRS-2 path-rows within the
{targets} architecture, we use a function <code>run_GEE_per_pathrow()</code> which writes
the current WRS-2 path-row to a text file, then sources a python script that
uses that text file to run the acquisition for the path-row. Additional details
are provided below to describe the steps in the python script
(<code>run_GEE_per_pathrow.py</code>).</p>
<div id="masking-functions" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Custom Earth Engine Masking Functions<a href="LS-SRST-pull.html#masking-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first section of <code>run_GEE_per_pathrow.py</code> saves custom functions used in the
Landsat stack acquisition. These include data manipulation to create Earth
Engine (EE) objects, custom QA masks, DSWE algorithm, and the functions that
perform the masking and extraction of data from the Landsat image. Below is an
overview of some of the custom masking procedures and their justification, if
applicable. We use the most aggressive masking procedures in the lakeSR and
siteSR products in order to attempt to have consistent and robust data across
such a large area of data acquisition. An interactive masking viewer is
available for select scenes for <a href="https://ee-aquamatch.projects.earthengine.app/view/asv2landsat57interactivemask">Landsat
4/5/7</a>
and <a href="https://ee-aquamatch.projects.earthengine.app/view/asv2landsat89interactivemask">Landsat
8/9</a>
to see some of the masks in action. In the descriptions below, “optical band” is
used to describe any non-thermal band.</p>
<ul>
<li><p><code>apply_rad_mask</code>: Masks out all pixels that are radiometrically saturated in
any optical band using the QA_RADSAT QA band. The Landsat User Guides
<span class="citation">(US Geological Survey 2021, 2024)</span> note that radiometrically
saturated data are “unusable”. Saturated bands happen infrequently in
Landsat 8 and 9, but we still apply this mask to all Landsat mission data
for continuity.</p></li>
<li><p><code>add_cf_mask</code>: Adds a mask band for any pixels obstructed by clouds and
snow/ice using the CLOUD_QA band. This is a general QA band that describes
clouds/snow/ice detected by algorithms defined by the atmospheric processing
procedure. We have elected to only include pixels that do not contain
clouds, cloud shadows, dispersed clouds, or snow/ice as defined by this
band. In particular, we follow the suggestions in the product User Guide
<span class="citation">(US Geological Survey 2021, 2024)</span></p>
<blockquote>
<p>Users are advised to engage the QA “Dilated Cloud” (bit 1) AND “Cloud”
(bit 3) OFF condition to correctly identify clear pixels over water.</p>
</blockquote></li>
<li><p><code>add_sr_aero_mask</code>: Adds a mask band for any pixels in Landsat 8 and 9 that
have ‘medium’ or ‘high’ aerosol QA flags from the SR_QA_AEROSOL band.
Because water is particularly difficult to assess from space, we are more
aggressive in this mask than suggested by the Landsat 8 and 9 User Guide
<span class="citation">(US Geological Survey 2024)</span> which states: “Note that pixels classified as high
aerosol content are not recommended for use.”</p></li>
<li><p><code>add_opac_mask</code>: Adds a mask band to remove pixels where atmospheric opacity
is greater than 0.3 in Landsat 4, 5, and 7 using the SR_ATMOS_OPACITY band.
For similar reasons as a more aggressive aerosol mask in Landsat 8 &amp; 9, we
use this mask in addition to the cloud mask (<code>apply_cf_mask</code>). The Landsat
4-7 User Guide <span class="citation">(US Geological Survey 2021)</span> states the following about the
atmospheric opacity values:</p>
<blockquote>
<p>A general interpretation of atmospheric opacity is that values less than
0.1 are clear, 0.1-0.3 are average, and values greater than 0.3 indicate
haze or other cloud situations. SR values from pixels with high
atmospheric opacity will be less reliable, especially under high solar
zenith angle conditions.</p>
</blockquote></li>
<li><p><code>apply_fill_mask_457</code> and <code>apply_fill_mask_89</code>: Adds a mask band where any
band value is 0 before applying scaling factors to bands. Filled values are
infrequent; however, when acquiring data across such a large area and time
they are bound to happen.</p></li>
<li><p><code>add_realistic_mask_457</code> and <code>add_realistic_mask_89</code>: Adds a mask band where
any band is less than -0.01 after scaling, indicating overcorrection of SR
product. While the stated minimum value of the ‘valid range’ for the SR
product is 7273 prior to application of scaling factors (0.0000075 after
scaling), we know that the Level-2 Surface Reflectance product has been
fine-tuned on terrestrial data and small over-corrections of surface
reflectance, especially over dark surfaces, are likely to happen. We
explicitly allow for very small negative reflectance values to be sure we do
not remove very deep, oligotrophic and/or high DOC water systems from our
data set while implementing this QA filter.</p></li>
<li><p><code>add_glint_mask</code>: Adds a mask band where any optical band is &gt; 0.2,
indicating likely sun glint artifacts.</p></li>
<li><p><code>add_ir_glint_flag</code>: Adds a band where any near infrared or shortwave
infrared value is greater than 0.1, but does not mask the pixel. This flag
is meant to be a diagnostic for downstream users to make additional
qualitative assessment of sun glint affected data and is tallied with all
masks implemented.</p></li>
</ul>
<p>We track pixel-level instances of the use of the aerosol mask in Landsat 8/9,
the opacity mask in Landsat 4/5/7, the realistic mask (holistically and per
band), and the sun glint mask (holistically and per band) in our GEE workflow.
These tallies represent the number of pixels masked for each QA procedure prior
to summarizing the data within the buffered area.</p>
</div>
<div id="dswe-implementation" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Defining water area<a href="LS-SRST-pull.html#dswe-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use an adapted version of the Dynamic Surface Water Extent (DSWE) algorithm
to define what pixels are water within the buffer of our specific locations.
DSWE was defined in <span class="citation">Jones (2019)</span> for Landsat Collection 1 and re-implemented for
Collection 2 as a Level-3 data product in <span class="citation">US Geological Survey (2023a)</span>. Differences
between the Level-3 implementation and the on-the-fly calculation made within
our workflow are as follows:</p>
<ol style="list-style-type: decimal">
<li><p>we use the Level 2 SR product instead of the Level 2 Analysis Ready Data
Product to calculate DSWE threshold values</p></li>
<li><p>we mask any DSWE values that are not fully illuminated (a value of 0 in the
function below) as defined by the ee.Terrain.hillShadow function in Google
Earth Engine using the MERIT DEM version 1.0.3 <span class="citation">(Yamazaki et al. 2017)</span> at an extent
of 3000 meters surrounding a given point for analysis.</p>
<div class="float">
<img src="images/hillshadow.png" width="600" alt="Screenshot of code used for implementation of hill shadow to determine masking procedures of the DSWE value." />
<div class="figcaption">Screenshot of code used for implementation of hill shadow to determine
masking procedures of the DSWE value.</div>
</div>
<p>This is different from the implementation described in the Level 3 data
product which uses a set of hillshade and landcover thresholds to determine
whether or not the resulting DSWE value should be masked. Based on extensive
visual inspection, our adaptation seems to label pixels as expected.</p></li>
</ol>
<p>Our implementation of the DSWE algorithm results in the following values per
pixel based on the thresholds described in <span class="citation">US Geological Survey (2023a)</span> table 2.2 and
2.3</p>
<ul>
<li><p>a value of 0 indicates no water/fill</p></li>
<li><p>1 is confident water</p></li>
<li><p>2 is low confidence water</p></li>
<li><p>3 is high confidence partial water (or vegetated water)</p></li>
<li><p>4 is low confidence partial water</p></li>
</ul>
<p>Within the scope of lakeSR and siteSR, we tabulate pixels that are a DSWE value
of 1 (DSWE1) for high confidence open water, or what we call DSWE1a - high
confidence open water OR the pixel meets a threshold that may indicate there is
surface-level algae. Like the QA masks, the DSWE implementation occurs in the
Python script <code>run_GEE_per_pathrow.py</code>. The algae mask is defined as when a
pixel has a DSWE value greater than 1 and the green band scaled value is greater
than 0.05 and the red band scaled value is less than 0.04. These values are
based on optical properties intended to mimic the spectral response of
chlorophyll <em>a</em> as described by <span class="citation">Burket, Olmanson, and Brezonik (2023)</span>. This is an experimental mask, so we
export both DSWE1 and DSWE1a summaries within lakeSR. We have found some
omission error within DSWE1 for visible floating scum within river systems and
this additional mask captures many of those pixels without adding unnecessary
uncertainty. Users of the lakeSR and siteSR data products can choose to use the
DSWE1a product if applicable to their research, however, this threshold was
defined in the Illinois and Ohio Rivers and may not be applicable in all
environments.</p>
</div>
</div>
<div id="diagnostic-columns" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Additional diagnostic data columns<a href="LS-SRST-pull.html#diagnostic-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>During the masking and flagging step of the workflow, we tally pixels that met
certain criteria for use as diagnostic tools, which are stored in the same file
as the summary remote sensing data. This includes tallying of varying DSWE types
(greater than 0 – water of some kind with any confidence, 1 high confidence
water, 1a high confidence water with positive algal mask, 3 high confidence
vegetated water) within the buffered area. These tallies are of any pixel that
meets the DSWE category and met the hillshade, cloud, opacity/aerosol,
realistic, and glint thresholds. The number of pixels that were high
opacity/high aerosol, overly negative values, and likely sun glint were also
tallied within the buffer. These tallies are of the entire buffer area and no
additional masks are incorporated into the tallies (e.g. the sun glint mask and
infrared mask may also indicate high reflectance from shoreline vegetation
within the buffered area). Counts of pixels were tallied per band to indicate
the number of pixels that were below zero, below the threshold for realistic
values, or above the glint threshold. These tallies were completed in
conjunction with the hillshade, cloud, opacity/aerosol and DSWE masks,
representing the number of pixels that were masked after the baseline pixel QA
process. The number of pixels that had infrared reflectance values (NIR, SWIR1,
and SWIR2) greater than 0.1 were also tallied, but these pixels were not masked
out. Columns for the proportion of pixels masked by clouds and shaded by terrain
are also provided, no additive mask is used when tallying these pixels. These
tallies are meant to be used as diagnostic tools for further quality control and
modeling purposes, though we do not have recommended uses at this time.</p>
</div>
<div id="payload-handling" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Payload handling<a href="LS-SRST-pull.html#payload-handling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Because GEE is a free service to those at academic or governmental institutions,
there are limits to the total number of tasks being run co-currently on GEE’s
platform. For this reason, tasks are sent to GEE as path-row groups as soon as
there are fewer than 10 tasks in the GEE tasks queue. Additionally, any path-row
containing more than 5,000 POI locations are sent as separate tasks in 5000
location chunks. This is an additional step that is taken in addition to
processing per path-row to avoid failed tasks. This management is orchestrated
within the <code>run_GEE_per_pathrow.py</code> script and through integration with
{targets} which runs this script per WRS-2 pathrow.</p>
<p>We have also implemented a status check for tasks sent to GEE to determine if
any have failed (Python script <code>check_for_failed_tasks.py</code>), as once the tasks
are sent from the RStudio IDE, you can not tell whether or not they have
completed or failed without (a) manually looking at the tasks list or (b)
programatically checking the task list. This stores a text file at the filepath
<code>b_pull_Landsat_SRST_poi/out/GEE_task_errors_vRUN_DATE.csv</code> containing the names
of the tasks that have failed. If no tasks have failed, no file will be present.
Generally speaking, failed tasks would indicate an error within the GEE
acquisition script, usually due to changes in the
<code>b_pull_Landsat_SRST_poi/py/run_GEE_per_pathrow.py</code> script. We recommend
checking the task status of the GEE run at
<a href="https://code.earthengine.google.com/tasks" class="uri">https://code.earthengine.google.com/tasks</a> after any changes to they GEE
functions file, which will indicate if tasks are failing due to code error
without waiting for the total completion of the GEE target.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="LS-C2-SRST.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="post-hoc-qa.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
